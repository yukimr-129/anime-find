{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback } from 'react';\nimport { useRecoilValue, useSetRecoilState } from 'recoil';\nimport { client } from \"../lib/api/client\";\nimport { ApiKeyValue } from '../store/ApiKeyValue';\nimport { useMessage } from './message/useMessage';\nimport { AnimeLists } from '../store/AnimeLists';\nimport { HasMore } from 'store/loding/HasMore';\nimport { LoadPage } from 'store/LoadPage';\nexport const useAnimeApiSearch = () => {\n  _s();\n\n  const setHasMore = useSetRecoilState(HasMore);\n  const setLoadPage = useSetRecoilState(LoadPage);\n  const setAnimeLists = useSetRecoilState(AnimeLists);\n  const apiKeyValue = useRecoilValue(ApiKeyValue);\n  const {\n    showMessage\n  } = useMessage(); //検索結果最初のリスト取得\n\n  const getAnimes = useCallback(async () => {\n    try {\n      const filter_season = `${apiKeyValue.year}-${apiKeyValue.cour}`;\n      const res = await client.get('/annicts/search', {\n        params: {\n          filter_season,\n          page: 1\n        }\n      });\n\n      if (res.status === 200) {\n        const animeDate = res.data.works;\n        setAnimeLists(animeDate); //検索でリスト再取得時にInfiniteScrollの値初期化\n\n        setHasMore(true);\n        setLoadPage(1);\n      } else {}\n    } catch (error) {\n      showMessage({\n        title: 'アニメ一覧の取得に失敗しました',\n        status: \"error\"\n      });\n    }\n  }, [apiKeyValue]);\n  return {\n    getAnimes\n  };\n};\n\n_s(useAnimeApiSearch, \"mkNF4LuhXwnCINDMEAq0B46F3vM=\", false, function () {\n  return [useSetRecoilState, useSetRecoilState, useSetRecoilState, useRecoilValue, useMessage];\n});","map":{"version":3,"sources":["/usr/src/app/react-app/src/customHooks/useAnimeApiSearch.ts"],"names":["useCallback","useRecoilValue","useSetRecoilState","client","ApiKeyValue","useMessage","AnimeLists","HasMore","LoadPage","useAnimeApiSearch","setHasMore","setLoadPage","setAnimeLists","apiKeyValue","showMessage","getAnimes","filter_season","year","cour","res","get","params","page","status","animeDate","data","works","error","title"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,SAASC,cAAT,EAAyBC,iBAAzB,QAAkD,QAAlD;AAEA,SAASC,MAAT,QAAuB,mBAAvB;AACA,SAASC,WAAT,QAA4B,sBAA5B;AACA,SAASC,UAAT,QAA2B,sBAA3B;AAEA,SAASC,UAAT,QAA2B,qBAA3B;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,SAASC,QAAT,QAAyB,gBAAzB;AAMA,OAAO,MAAMC,iBAAiC,GAAG,MAAM;AAAA;;AACnD,QAAMC,UAAU,GAAGR,iBAAiB,CAACK,OAAD,CAApC;AACA,QAAMI,WAAW,GAAGT,iBAAiB,CAACM,QAAD,CAArC;AACA,QAAMI,aAAa,GAAGV,iBAAiB,CAACI,UAAD,CAAvC;AACA,QAAMO,WAAW,GAAGZ,cAAc,CAACG,WAAD,CAAlC;AACA,QAAM;AAAEU,IAAAA;AAAF,MAAkBT,UAAU,EAAlC,CALmD,CAO/C;;AACA,QAAMU,SAAS,GAAGf,WAAW,CAAC,YAAW;AACrC,QAAI;AACA,YAAMgB,aAAa,GAAI,GAAEH,WAAW,CAACI,IAAK,IAAGJ,WAAW,CAACK,IAAK,EAA9D;AACA,YAAMC,GAAG,GAAG,MAAMhB,MAAM,CAACiB,GAAP,CAAW,iBAAX,EAA8B;AAC5CC,QAAAA,MAAM,EAAE;AACJL,UAAAA,aADI;AAEJM,UAAAA,IAAI,EAAE;AAFF;AADoC,OAA9B,CAAlB;;AAOA,UAAIH,GAAG,CAACI,MAAJ,KAAe,GAAnB,EAAwB;AACpB,cAAMC,SAA0B,GAAGL,GAAG,CAACM,IAAJ,CAASC,KAA5C;AAEAd,QAAAA,aAAa,CAACY,SAAD,CAAb,CAHoB,CAKpB;;AACAd,QAAAA,UAAU,CAAC,IAAD,CAAV;AACAC,QAAAA,WAAW,CAAC,CAAD,CAAX;AACH,OARD,MAQO,CAEN;AAEJ,KArBD,CAqBE,OAAOgB,KAAP,EAAc;AACZb,MAAAA,WAAW,CAAC;AAACc,QAAAA,KAAK,EAAE,iBAAR;AAA2BL,QAAAA,MAAM,EAAE;AAAnC,OAAD,CAAX;AACH;AACJ,GAzB4B,EAyB1B,CAACV,WAAD,CAzB0B,CAA7B;AA2BJ,SAAO;AAAEE,IAAAA;AAAF,GAAP;AACH,CApCM;;GAAMN,iB;UACUP,iB,EACCA,iB,EACEA,iB,EACFD,c,EACII,U","sourcesContent":["import { useCallback } from 'react'\nimport { useRecoilValue, useSetRecoilState } from 'recoil'\n\nimport { client } from \"../lib/api/client\"\nimport { ApiKeyValue } from '../store/ApiKeyValue'\nimport { useMessage } from './message/useMessage'\nimport { AnnictApiType } from '../types/api/AnnictApiType'\nimport { AnimeLists } from '../store/AnimeLists'\nimport { HasMore } from 'store/loding/HasMore'\nimport { LoadPage } from 'store/LoadPage'\n\ntype AnimeApiSearch = () => {\n        getAnimes: () => void;\n}\n\nexport const useAnimeApiSearch: AnimeApiSearch = () => {\n    const setHasMore = useSetRecoilState(HasMore)\n    const setLoadPage = useSetRecoilState(LoadPage)\n    const setAnimeLists = useSetRecoilState(AnimeLists)\n    const apiKeyValue = useRecoilValue(ApiKeyValue)\n    const { showMessage } = useMessage()\n        \n        //検索結果最初のリスト取得\n        const getAnimes = useCallback(async() => {\n            try {\n                const filter_season = `${apiKeyValue.year}-${apiKeyValue.cour}`\n                const res = await client.get('/annicts/search', {\n                    params: {\n                        filter_season,\n                        page: 1\n                    }\n                })\n\n                if (res.status === 200) {\n                    const animeDate: AnnictApiType[] = res.data.works \n            \n                    setAnimeLists(animeDate)\n    \n                    //検索でリスト再取得時にInfiniteScrollの値初期化\n                    setHasMore(true)\n                    setLoadPage(1)  \n                } else {\n                    \n                }\n                \n            } catch (error) {\n                showMessage({title: 'アニメ一覧の取得に失敗しました', status: \"error\"})\n            } \n        }, [apiKeyValue])\n\n    return { getAnimes }\n}"]},"metadata":{},"sourceType":"module"}